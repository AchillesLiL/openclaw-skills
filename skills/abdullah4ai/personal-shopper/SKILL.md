---
name: personal-shopper
description: |
  المتسوق الشخصي الذكي - بحث منتجات بمنهجية Diamond Search (7 وكلاء في 3 طبقات).
  USE WHEN: user wants product recommendation, shopping advice, أبغى أشتري, وش أفضل منتج, قارن لي, ابحث لي عن.
  DON'T USE WHEN: user wants price tracking over time, order placement, or returns/refunds help.
  Output: Product recommendations with best price, availability, and expert validation.
---

# المتسوق الشخصي - Diamond Search

## معايير المنتج الذهبي (Golden Product)

| # | المعيار | الوصف |
|---|---------|-------|
| 1 | الأداء | يأدي المطلوب بكفاءة عالية للاستخدام المحدد |
| 2 | القيمة | السعر مبرر مقابل الأداء الفعلي |
| 3 | التوفر | متوفر في السوق السعودي بضمان وخدمة |
| 4 | الموثوقية | تقييمات حقيقية إيجابية من مستخدمين فعليين |
| 5 | التوقيت | مو على وشك ينزل جيل جديد أو ينوقف إنتاجه |

## الوكلاء السبعة

| # | الوكيل | الدور | الطبقة |
|---|--------|-------|--------|
| 1 | Mainstream Research | بحث في المصادر الرئيسية: Reddit, YouTube, Wirecutter, RTINGS | Search |
| 2 | Anti-Bias | بحث عكسي ومصادر بديلة لكسر فقاعة النتائج المكررة | Search |
| 3 | Local Market Scanner | مسح السوق السعودي: Amazon.sa, noon, jarir, extra | Search |
| 4 | Niche Community Diver | منتديات متخصصة، مجموعات Facebook، سيرفرات Discord | Search |
| 5 | Domain Expert | خبير المجال، يحكم على النتائج بأسئلة تقنية، لا يبحث | Expertise |
| 6 | Latest Tech | آخر 6 شهور، إعلانات CES، منتجات متوقفة أو قادمة | Expertise |
| 7 | Price & Deal Hunter | كوبونات، كاشباك، تقسيط، مقارنة أسعار بين المنصات | Price |

> للتفاصيل الكاملة لكل وكيل: اقرأ `references/diamond-methodology.md`

## سير العمل (5 مراحل)

### المرحلة 1: BRIEF (تسلسلي)

اجمع من المستخدم:
- وش المنتج المطلوب
- الميزانية (أو "مفتوحة")
- الاستخدام الرئيسي
- أي تفضيلات أو شروط
- هل عنده خيارات مبدئية

اذا المستخدم ما وضح، اسأل. لا تفترض.

### المرحلة 2a: طبقة البحث (متوازي)

انشئ 4 sub-agents بالتوازي باستخدام `sessions_spawn`:

```
sessions_spawn([
  {
    name: "agent-1-mainstream",
    prompt: "أنت جزء من فريق بحث مكوّن من 7 وكلاء. دورك: Mainstream Research. زملاؤك يغطون الزوايا الأخرى — ركّز على دورك بالتحديد.\n\nالمنتج: {product}\nالميزانية: {budget}\nالاستخدام: {use_case}\n\nابحث في: Reddit, YouTube reviews, Wirecutter, RTINGS.\nالمطلوب: أفضل 3-5 خيارات مع مصادر."
  },
  {
    name: "agent-2-anti-bias",
    prompt: "أنت جزء من فريق بحث مكوّن من 7 وكلاء. دورك: Anti-Bias Research. زملاؤك يغطون الزوايا الأخرى — ركّز على دورك بالتحديد.\n\nالمنتج: {product}\nالميزانية: {budget}\n\nاستخدم استراتيجيات البحث العكسي: negative search, brand alternatives, origin-based search.\nالهدف: اكتشاف خيارات ما تطلع في البحث العادي.\nمهم: وسّع الأفق، لا تستبعد الخيارات المشهورة."
  },
  {
    name: "agent-3-local-market",
    prompt: "أنت جزء من فريق بحث مكوّن من 7 وكلاء. دورك: Local Market Scanner. زملاؤك يغطون الزوايا الأخرى — ركّز على دورك بالتحديد.\n\nالمنتج: {product}\nالميزانية: {budget}\n\nامسح: Amazon.sa, noon.com, jarir.com, extra.com.\nالمطلوب: الأسعار الفعلية، التوفر، البائع (رسمي/موزع/طرف ثالث)، الشحن والضمان."
  },
  {
    name: "agent-4-niche",
    prompt: "أنت جزء من فريق بحث مكوّن من 7 وكلاء. دورك: Niche Community Diver. زملاؤك يغطون الزوايا الأخرى — ركّز على دورك بالتحديد.\n\nالمنتج: {product}\nالاستخدام: {use_case}\n\nابحث في: منتديات متخصصة، مجموعات Facebook، Discord servers، مجتمعات Reddit الصغيرة.\nالمطلوب: توصيات من محترفين ومستخدمين متقدمين."
  }
])
```

انتظر اكتمال الأربعة قبل المرحلة التالية.

### المرحلة 2b: طبقة الخبرة (متوازي)

انشئ 2 sub-agents بالتوازي:

```
sessions_spawn([
  {
    name: "agent-5-expert",
    prompt: "أنت جزء من فريق بحث مكوّن من 7 وكلاء. دورك: Domain Expert. زملاؤك يغطون الزوايا الأخرى — ركّز على دورك بالتحديد.\n\nالمنتج: {product}\nالاستخدام: {use_case}\n\nنتائج البحث من الطبقة الأولى:\n{search_layer_results}\n\nأنت خبير في هالمجال. لا تبحث. حلل النتائج واسأل 5 أسئلة تقنية:\n1. هل المواصفات تخدم الاستخدام الفعلي؟\n2. وش الفرق الحقيقي بين الخيارات؟\n3. هل فيه مواصفات مبالغ فيها (overkill)؟\n4. وش اللي ما ينذكر في المراجعات عادة؟\n5. لو أنا بشتري لنفسي، وش بختار ولِيه؟"
  },
  {
    name: "agent-6-latest",
    prompt: "أنت جزء من فريق بحث مكوّن من 7 وكلاء. دورك: Latest Tech Tracker. زملاؤك يغطون الزوايا الأخرى — ركّز على دورك بالتحديد.\n\nالمنتج: {product}\n\nابحث عن:\n- منتجات أُعلنت آخر 6 شهور\n- إعلانات CES/MWC الأخيرة\n- جيل جديد قادم خلال 3 شهور\n- منتجات توقف إنتاجها أو على وشك\n- مقارنة الجيل الحالي بالسابق\n\nالمطلوب: هل الوقت مناسب للشراء ولا الأفضل ينتظر؟"
  }
])
```

### المرحلة 3: التجميع (تسلسلي)

اجمع كل النتائج وطبّق قواعد التجميع:

**قواعد:**
- إجماع 3 من 4 وكلاء بحث = إشارة قوية، لكن تحقق إنهم ما اعتمدوا على نفس المصدر
- رأي الخبير (Agent 5) يتفوق على Latest Tech (Agent 6) عند التعارض
- اذا ما فيه بديل حقيقي بقيمة أفضل، قلها بصراحة
- طبّق معايير المنتج الذهبي الخمسة على كل خيار

> للتفاصيل: اقرأ `references/anti-bias-playbook.md` و `references/domain-expertise.md`

### المرحلة 4: طبقة السعر (تسلسلي)

وكيل واحد:

```
sessions_spawn([
  {
    name: "agent-7-price",
    prompt: "أنت جزء من فريق بحث مكوّن من 7 وكلاء. دورك: Price & Deal Hunter. زملاؤك يغطون الزوايا الأخرى — ركّز على دورك بالتحديد.\n\nالمنتجات النهائية:\n{converged_products}\n\nلكل منتج، ابحث عن:\n1. أفضل سعر حالي على كل منصة سعودية\n2. كوبونات أو أكواد خصم فعّالة\n3. عروض كاشباك (بطاقات بنكية، تطبيقات)\n4. خيارات تقسيط بدون فوائد\n5. برامج Trade-in\n6. تحقق من نوع البائع والشحن والضريبة\n\nنبّه اذا لقيت Price Inversion (سعر محلي أغلى من الدولي بفرق كبير)."
  }
])
```

> للتفاصيل: اقرأ `references/market-dynamics.md`

### المرحلة 5: المخرجات

قدم النتائج بالشكل التالي:

```
## التوصية: {product_name}

### لِيه هالمنتج؟
{سبب الاختيار بناءً على معايير المنتج الذهبي}

### المقارنة السريعة

| المنتج | السعر | المنصة | التقييم | ملاحظة |
|--------|-------|--------|---------|--------|
| ...    | ...   | ...    | ...     | ...    |

### أفضل سعر متاح
- المنصة: {platform}
- السعر: {price} ريال
- البائع: {seller_type}
- كوبون: {coupon_if_any}
- كاشباك: {cashback_if_any}

### تنبيهات
- {timing_advice}
- {price_inversion_warning_if_any}

### البدائل
1. {alternative_1} - {why}
2. {alternative_2} - {why}
```

## المراجع

| الملف | اقرأه متى |
|-------|-----------|
| `references/diamond-methodology.md` | تحتاج تفاصيل الوكلاء أو تعدّل الـ prompts |
| `references/anti-bias-playbook.md` | تحتاج استراتيجيات بحث عكسي أو تقييم براند غير معروف |
| `references/domain-expertise.md` | تحتاج تفهم منطق الخبير أو تشوف أمثلة واقعية |
| `references/market-dynamics.md` | تحتاج تفهم أنماط التسعير في السوق السعودي |

## ملاحظات التنفيذ

- عدد الوكلاء مرن: لو المنتج بسيط، ممكن تستغني عن Agent 4 أو Agent 6
- لا تحدد موديل معين: استخدم "fast search model" للبحث و "reasoning model" للتحليل
- كل sub-agent يشتغل مستقل ولا يشوف نتائج زملاءه (الا طبقة الخبرة تشوف نتائج البحث)

## القاعدة الذهبية

> المنتج يرتكز على القيمة، مو على البراند
